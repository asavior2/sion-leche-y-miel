<ion-header mode="md" class="reader-header">
  <ion-toolbar>

    <ion-buttons slot="start">
      <ion-menu-button color="primary" *ngIf="!history"></ion-menu-button>
      <ion-button (click)="returnToContext()" *ngIf="history" color="primary">
        <ion-icon name="arrow-back" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>

    <div class="book-selector-capsule" align="center">
      <ion-button fill="clear" (click)="mostrarLibrosMetodo()" class="capsule-btn book-btn">
        {{librot}}
      </ion-button>
      <span class="divider">|</span>
      <ion-button fill="clear" (click)="mostrarCapitulosMetodo(libro)" class="capsule-btn chapter-btn">
        {{capitulo}}
      </ion-button>
    </div>

    <ion-buttons slot="end" class="reading-controls">
      <ion-button (click)="disminuirSize()" class="font-control small">
        <span class="text-icon">A</span>
      </ion-button>
      <ion-button (click)="aumentarSize()" class="font-control large">
        <span class="text-icon">A</span>
      </ion-button>
      <ion-button (click)="changeDark()">
        <ion-icon name="{{estadoDark}}" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>

  </ion-toolbar>
</ion-header>

<ion-content class="reader-content">

  <div class="sticky-footer" [class.valid]="isMenuOpen">
    <div class="menu-content ion-padding">

      <div class="action-row">
        <div class="action-item" (click)="marcarVersiculo()">
          <div class="icon-circle"><ion-icon name="bookmark"></ion-icon></div>
          <ion-label>Marcar</ion-label>
        </div>
        <div class="action-item" (click)="crearNota()">
          <div class="icon-circle"><ion-icon name="document-text"></ion-icon></div>
          <ion-label>Nota</ion-label>
        </div>
        <div class="action-item" (click)="copiarVersiculo()">
          <div class="icon-circle"><ion-icon name="copy"></ion-icon></div>
          <ion-label>Copiar</ion-label>
        </div>
        <div class="action-item" (click)="compartirVersiculo()">
          <div class="icon-circle"><ion-icon name="share-social"></ion-icon></div>
          <ion-label>Compartir</ion-label>
        </div>
      </div>

      <div class="color-row">
        <div *ngFor="let color of ['#FFF9C4', '#DCEDC8', '#B3E5FC', '#F8BBD0', '#E1BEE7']" class="color-dot"
          [style.background-color]="color" [class.selected]="selectedColor === color" (click)="seleccionarColor(color)">
          <ion-icon name="checkmark" *ngIf="selectedColor === color"></ion-icon>
        </div>
      </div>
    </div>
  </div>

  <div class="main-reading-container">

    <div *ngIf="mostrarLibros" class="selection-area animate-fade-in">

      <div class="segment-wrapper">
        <ion-segment [(ngModel)]="tipoOrdenName" mode="ios" class="custom-segment">
          <ion-segment-button value="tradicional" (click)="tipoOrdenLibro('tradicional')">
            <ion-label>Lista</ion-label>
          </ion-segment-button>
          <ion-segment-button value="moderno" (click)="tipoOrdenLibro('moderno')">
            <ion-label>Mosaico</ion-label>
          </ion-segment-button>
          <ion-segment-button value="hebreo" (click)="tipoOrdenLibro('hebreo')">
            <ion-label>Hebreo</ion-label>
          </ion-segment-button>
        </ion-segment>
      </div>

      <div class="search-box-wrapper" *ngIf="tipoOrdenName !== 'moderno'">
        <ion-icon name="search-outline"></ion-icon>
        <input class="custom-input" placeholder="Buscar libro..." type="text" (input)="filterListLibro($event)">
      </div>

      <div *ngIf="tipoOrdenT" class="list-view">
        <ion-list lines="none">
          <ion-item button *ngFor="let libro of librosTodos" (click)="mostrarCapitulosMetodo(libro.id, libro.capitulos)"
            class="book-list-item">
            <ion-label>{{ libro.libro }}</ion-label>
            <span class="chapter-count">{{libro.capitulos}} cap</span>
            <ion-icon name="chevron-forward" slot="end" color="medium"></ion-icon>
          </ion-item>
        </ion-list>
      </div>

      <div *ngIf="tipoOrdenM" class="grid-view">

        <h3 class="pacto-header">Primer Pacto</h3>
        <div class="books-grid">
          <div class="book-tile" *ngFor="let libro of primerP"
            (click)="mostrarCapitulosMetodo(libro.id, libro.capitulos)">
            {{ libro.libro | slice:0:3 }} <span class="full-name">{{ libro.libro }}</span>
          </div>
        </div>

        <h3 class="pacto-header">Segundo Pacto</h3>
        <div class="books-grid">
          <div class="book-tile new-testament" *ngFor="let libro of segundoP"
            (click)="mostrarCapitulosMetodo(libro.id, libro.capitulos)">
            <span class="full-name">{{ libro.libro }}</span>
          </div>
        </div>
      </div>

      <div *ngIf="tipoOrdenH" class="list-view hebrew-view">
        <div *ngFor="let libro of librosTodosHebreo">
          <div class="section-divider" [innerHTML]="libro.seccion"></div>

          <ion-item button (click)="mostrarCapitulosMetodo(libro.id, libro.capitulos)" class="book-list-item">
            <ion-label class="hebrew-font">{{ libro.libro }}</ion-label>
            <span class="chapter-count">{{libro.capitulos}}</span>
          </ion-item>
        </div>
      </div>
    </div>


    <div *ngIf="mostrarCapitulos" class="selection-area animate-fade-in" align="center">
      <h3 class="selection-title">Selecciona el Cap√≠tulo</h3>
      <div class="chapters-grid">
        <button class="chapter-circle" *ngFor="let item of cantCapitulo" (click)="mostrarTextoMetodo(this.libro, item)">
          {{item}}
        </button>
      </div>
    </div>


    <div class="text-container animate-fade-in" *ngIf="mostrarTexto">

      <app-bible-viewer [content]="textoJsonFinal" [fontSize]="fontSize" [notes]="notas" [highlights]="highlightsMap"
        (verseClick)="seleccionarVersiculo($event.texto, $event.idLibro, $event.capitulo, $event.versiculo)"
        (citationClick)="citaAlert($event.cita, $event.ibroCita, $event.capituloCita, $event.versiculoCitaInicial, $event.versiculo)"
        (noteClick)="verNota($event.capitulo, $event.versiculo)">
      </app-bible-viewer>

      <div class="text-footer">
        <img src="assets/icon/icon-small.png" class="footer-logo">
        <span>Sion: Leche y Miel</span>
      </div>
      <div id="bottom-sentinel"></div>
    </div>

  </div>

  <ng-container *ngIf="mostrarTexto">
    <ion-fab vertical="bottom" horizontal="start" slot="fixed" [class.raise-fabs]="isMenuOpen">
      <ion-fab-button (click)="previousboton()" class="nav-fab glass">
        <ion-icon name="chevron-back"></ion-icon>
      </ion-fab-button>
    </ion-fab>

    <ion-fab vertical="bottom" horizontal="center" slot="fixed" [class.raise-fabs]="isMenuOpen">
      <ion-fab-button (click)="playAudio()" class="play-fab gold">
        <ion-icon [name]="playPausa"></ion-icon>
      </ion-fab-button>
    </ion-fab>

    <ion-fab vertical="bottom" horizontal="end" slot="fixed" [class.raise-fabs]="isMenuOpen">
      <ion-fab-button (click)="nextboton()" class="nav-fab glass">
        <ion-icon name="chevron-forward"></ion-icon>
      </ion-fab-button>
    </ion-fab>
  </ng-container>


</ion-content>