<ion-header mode="md" class="transparent-header">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/" color="primary"></ion-back-button>
    </ion-buttons>
    <ion-title class="header-title">Concordancia</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="concordance-content">

  <div class="main-container">

    <div class="search-section">
      <form [formGroup]="concordanciaForm" (ngSubmit)="getItems()">
        <div class="search-box-wrapper">
          <ion-icon name="search-outline" class="search-icon"></ion-icon>
          <input formControlName="palablaBuscar" class="custom-input" placeholder="Escribe una palabra (ej: Amor)"
            type="text" enterkeyhint="search">
        </div>

        <ion-button expand="block" type="submit" class="btn-search-gold" [disabled]="!concordanciaForm.valid">
          Buscar en las Escrituras
        </ion-button>
      </form>
    </div>

    <div class="results-area" *ngIf="showText">

      <div class="results-header" *ngIf="versiculos.length > 0">
        <span class="count-badge">{{ versiculos.length }}</span>
        <span class="count-label">coincidencias encontradas</span>
      </div>

      <div class="verse-list">
        <div class="verse-card" *ngFor="let versiculo of versiculos">

          <div class="verse-ref">
            <ion-icon name="bookmark" class="ref-icon"></ion-icon>
            {{versiculo.nombreLibro}} {{versiculo.capitulo}}:{{versiculo.versiculo}}
          </div>

          <div class="verse-text">
            <span [innerHTML]="versiculo.textoHTML"></span>
          </div>

          <ion-button fill="clear" size="small" class="btn-read-more" (click)="goToContext(versiculo)">
            Leer contexto
            <ion-icon slot="end" name="arrow-forward-outline"></ion-icon>
          </ion-button>
        </div>
      </div>

      <div class="load-more-container" *ngIf="hasMoreResults">
        <ion-button fill="outline" class="btn-outline-gold" (click)="loadMoreResults()">
          <ion-icon slot="start" name="add-circle-outline"></ion-icon>
          Ver más resultados ({{searchResults.length - versiculos.length}} restantes)
        </ion-button>
      </div>
    </div>

    <div *ngIf="searchResults.length === 0 && !isLoading && showText" class="no-results-state">
      <ion-icon name="book-outline"></ion-icon>
      <h3>Sin resultados</h3>
      <p>Intenta con otra palabra o verifica la ortografía.</p>
    </div>

    <div *ngIf="!showText" class="initial-state">
      <ion-icon name="search-circle-outline"></ion-icon>
      <p>Busca palabras clave para explorar<br>la sabiduría de Sion.</p>
    </div>

  </div>
</ion-content>