<ion-header mode="md" class="transparent-header">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="atras()" color="primary">
        <ion-icon name="arrow-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title class="header-title">{{ this.titulo }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="plan-detail-content">

  <div class="main-container">

    <div class="hero-section">
      <div class="image-wrapper">
        <ion-img [src]="this.imagen" class="cover-img"></ion-img>
      </div>
      <p class="plan-description">
        {{ this.descripcion }}
      </p>
    </div>

    <div class="calendar-strip">
      <h3 class="section-label">Tu Jornada</h3>

      <swiper-container #swiper slides-per-view="5.5" space-between="10" class="custom-swiper">
        <swiper-slide *ngFor="let dia of renderedDays" (click)="obtenerLibroCapitulos(dia.dia, dia.libro, dia.detalles)"
          class="day-slide">

          <div class="day-pill" [class.active]="statusSlide(dia.dia)" [class.completed]="dia.statusDia"
            [class.missed]="marcarDiasFaltantes(dia.dia) && !dia.statusDia">

            <span class="day-number">Día {{ dia.dia }}</span>

            <div class="indicator">
              <ion-icon name="checkmark-circle" *ngIf="dia.statusDia"></ion-icon>
              <ion-icon name="alert-circle" *ngIf="marcarDiasFaltantes(dia.dia) && !dia.statusDia"></ion-icon>
              <span class="date-label" *ngIf="statusBadge(dia.dia)">{{this.dd}} {{this.mmS}}</span>
            </div>
          </div>

        </swiper-slide>
      </swiper-container>
    </div>

    <div class="status-section">

      <div *ngIf="!this.verDiaAtraso && !this.btnIniciarPlan" class="status-card success">
        <ion-icon name="ribbon-outline"></ion-icon>
        <div class="status-text">
          <strong>¡Excelente trabajo!</strong>
          <p>Estás al día con tu lectura.</p>
        </div>
      </div>

      <div *ngIf="this.verDiaAtraso" class="status-card warning">
        <div class="status-header">
          <span class="day-counter">Día {{this.diaLecturaV}} <span class="muted">de {{this.diaFinPlan}}</span></span>
        </div>
        <div class="delay-msg">
          Tienes <strong>{{this.diaAtraso}} días</strong> pendientes.
          <br>¡No te desanimes, ponte al día hoy!
        </div>
      </div>
    </div>

    <div class="reading-list" *ngIf="verCapitulos">
      <h3 class="section-label">Lectura de Hoy</h3>

      <div class="chapter-card" *ngFor="let item of detallesDia">
        <div class="chapter-info"
          (click)="pushLeerPlan(item.libro, item.capitulo, item.versiculo, item.versiculoFinal)">
          <span class="book-name">{{obtenerNombreLibro(item.libro)}}</span>
          <span class="chapter-num">{{item.capitulo}}</span>
          <span class="verses" *ngIf="item.versiculo || item.versiculoFinal">
            : {{item.versiculo}}<span *ngIf="item.versiculoFinal">-{{item.versiculoFinal}}</span>
          </span>
        </div>

        <div class="action-check">
          <ion-checkbox mode="ios" [(ngModel)]="item.status"
            (ionChange)="statusCheckbox(this.dia, item.libro, item.capitulo)" class="gold-checkbox">
          </ion-checkbox>
        </div>
      </div>
    </div>

    <div class="footer-actions" *ngIf="this.btnIniciarPlan">
      <ion-button expand="block" class="btn-gold-gradient" (click)="iniciarPlan()">
        Comenzar este Plan
        <ion-icon slot="end" name="arrow-forward"></ion-icon>
      </ion-button>
    </div>

  </div>
</ion-content>